# Implementation Plan: [FEATURE NAME]

<!--
  Template: Implementation Plan

  Purpose: Define technical approach and work breakdown for Feature implementation.
  Used by: /spec-mesh plan workflow

  Prerequisites:
    - Feature Spec must exist and be approved
    - [NEEDS CLARIFICATION] count must be 0 (CLARIFY GATE)

  See: .claude/skills/spec-mesh/guides/id-naming.md for ID formats
  See: .claude/skills/spec-mesh/constitution.md for workflow rules
-->

Plan ID: PLAN-{AREA}-{NNN}
Feature Spec: S-{AREA}-{NNN}
Related Domain Spec: S-DOMAIN-001
Related Screen Spec: S-SCREEN-001
Related Screens: [SCR-001, SCR-002, etc.]
Branch: feature/{issue}-{slug}
Issue(s): [#123, #124]
Created: {date}
Owner: [ENGINEER / TEAM]

Input: Feature Spec from `.specify/specs/features/{feature}/spec.md`.
Note: This plan is generated by `/spec-mesh plan` and reviewed by humans before tasks.

---

## 1. Summary

- One-sentence summary of the change:
- What user stories or use cases are being implemented (IDs):
- Dependencies on:

  - Domain spec:
  - Other Feature specs:
  - External systems:
  - Target code areas (directories/files expected to change):
  - Context sources to consult: Serena (repo structure), context7 (docs/SDK)

---

## 2. Scope and Out-of-Scope

### 2.1 In-scope

- Functions and flows implemented in this change:
- Data entities touched:
- APIs implemented or modified:

### 2.2 Out-of-scope

- Related features intentionally not implemented in this change:
- Deferred items to future specs or issues:

---

## 3. Technical Approach

### 3.1 High-Level Design

- Overall architecture for this feature:
- Main components (backend, frontend, jobs, etc.):
- How the feature integrates into the existing system:
- Expected file layout and target directories for changes:

### 3.2 Data and Schema Changes

- New tables or collections (if any):
- Schema changes to existing entities:

  - Which master (`M-...`) or entity:
  - Fields added/removed/changed:
  - Migration strategy:

- Impact on read/write patterns.

### 3.3 API Design

- APIs to add or modify:

  - Existing API IDs from Domain spec:
  - New API IDs defined in the Feature spec:

- Request/response mapping to domain entities:
- Error handling strategy.
- If adding/changing shared contracts, confirm corresponding Domain spec updates.

---

## 4. Dependencies and Integration

- Internal dependencies (other modules or services):
- External dependencies (third-party APIs, queues, etc.):
- Order of integration:

  - What MUST be deployed together:
  - What can be deployed behind feature flags:

---

## 5. Testing Strategy

- Test levels and responsibilities:

  - Unit tests for:
  - Integration tests for:
  - E2E tests for:

- How to ensure:

  - Tests are derived from spec user stories and acceptance criteria.
  - Tests fail first when behavior is missing or incorrect.
  - We do not modify code or tests solely to appease CI.

- Required test data or fixtures:
- How to run tests locally and in CI:

---

## 6. Observability and Operations

- Logging strategy (what to log, where, and at which level):
- Metrics to emit (counters, gauges, timers):
- Alerts related to this feature:
- Runbooks or operational notes (if applicable):

---

## 7. Risks and Trade-offs

- Design trade-offs (for example simplicity vs flexibility):
- Known risks and mitigations:
- Failure modes and how they are handled:

---

## 8. Open Questions and Approvals

- Unresolved decisions or clarifications required:
- Approvals needed (for example schema changes, contract changes):
- Follow-up items if shortcuts are taken:

---

## 9. Rollout and Migration Plan

- Deployment strategy:

  - Single-shot / blue-green / canary / feature flag:

- Data migration steps:
- Rollback strategy:

---

## 10. Constitution Check

Verify this plan complies with the Engineering Constitution:

- Spec-driven workflow:

  - Change is linked to Issue(s).
  - Related spec(s) exist and are up to date.
  - Domain spec is referenced when shared masters/APIs are involved.
  - Spec/Use Case IDs are carried into tasks, PR description, and planned tests.

- Git & GitHub workflow:

  - Branch naming follows `feature/<issue>-...` or `spec/<issue>-...`.
  - Work will be merged via PR and squash merge.
  - PR will reference both Issue(s) and Spec ID(s).

- Test integrity:

  - Tests are designed from spec, not from current implementation.
  - There is an explicit plan to diagnose failures
    (spec vs tests vs implementation vs environment).

- AI agent conduct:

  - Tasks are small enough for AI agents to handle safely.
  - AI agents will not be asked to violate constitutional rules.

If any item is intentionally violated, document:

- Violation:
- Justification:
- Mitigation or follow-up plan:

---

## 11. Work Breakdown (Link to Tasks)

High-level mapping from this plan to tasks:

- Task group 1: [Summary] -> [Task IDs]
- Task group 2: [Summary] -> [Task IDs]
- Task group 3: [Summary] -> [Task IDs]

This mapping will be materialized in `tasks.md`.
