<!-- Preserved Input -->
<!-- Source: vision-input.md -->
<!-- Date: 2025-12-25T05:55:46.728Z -->

# Vision Quick Input（統合版）

新しいプロジェクトの概要を入力してください。
**画面リストまで入力すると、より精度の高い Spec が生成されます。**

---

## Part A: ビジョン（必須）

### A1. 基本情報

- **プロジェクト名**: Quon案件管理システム
- **一言で説明すると**: 営業案件・アサイン管理・売上計上を一元管理するシステム

---

### A2. 課題

- **現状の問題**:
  - 経営陣・経営企画が「案件ポートフォリオ・売上推移」を横串で把握できない
  - セクター長／マネージャーが「メンバーのアサイン状況・空き状況」を即座に把握できない
  - 受注案件とアサインメンバー、売上計上状況の管理が分散している
- **なぜ解決したいか**:
  - 経営判断のスピード向上
  - メンバーリソースの最適活用
  - 売上・予算管理の精度向上

---

### A3. ユーザー

- **主なユーザー**:
  - 経営陣（全案件の売上・粗利・将来売上見込みの俯瞰）
  - 経営企画室（予算対実績・KPIモニタリング・レポーティング）
  - セクター長／マネージャー（自セクター案件の受注・アサイン・売上管理）
  - PJオーナー（自案件の情報登録・更新、メンバーアサイン調整）
  - 管理部門・経理（売上計上・会計伝票照会）
  - システム管理者（マスタ管理、権限管理、監査ログ閲覧）
- **ユーザーが達成したいこと**:
  - 案件の受注から売上計上までの全工程を一元管理
  - メンバーのアサイン状況・空き状況をリアルタイムで把握
  - ダッシュボードで案件状況・売上推移を俯瞰

---

### A4. やりたいこと (3-7個)

1. 受注伝票の登録・変更・照会（案件情報とメンバー明細の管理）
2. 売上計上処理（月次で会計伝票を一括作成）
3. 案件ダッシュボード（受注・売上・目標推移のグラフ表示）
4. アサイン状況マトリクス（メンバー×月の稼働状況可視化）
5. マスタ管理（クライアント、メンバー、セクター等）
6. 監査ログ照会（全更新操作の記録・検索）
7. 参照登録（過去案件からの情報引継ぎ）

---

### A5. やらないこと (任意)

- 多通貨対応（初期リリースではJPY固定、将来拡張）
- 引合伝票管理（別システム想定）
- 勤怠管理・工数入力機能

---

### A6. 制約・前提条件 (任意)

- **組織構造**: セクター単位で案件・メンバーを管理。Tier1/2/3の案件分類あり。
- **ビジネスロジック**:
  - チャージ率 = 実売単価 ÷ 社内標準売価 × 100
  - 稼働月数 = (終了日 - 開始日 + 1日) / 30
  - 会計伝票はDr（売掛金）/Cr（売上）の2行ペア
- **技術制約**:
  - フロントエンド: Next.js（React + TypeScript）
  - バックエンド: Python（FastAPI）
  - DB: Azure SQL Database
  - 認証: Azure AD（Microsoft SSO）
- **その他**:
  - 案件編集時は排他ロックを取得
  - 応答時間目標: 検索系3秒以内、登録系5秒以内（P95）

---

## Part B: 画面イメージ（任意だが推奨）

> **Note**: 画面リストが明確な場合は記入してください。
> 空欄でも Vision Spec は作成できますが、後の design ワークフロー で再度入力が必要になります。

### B1. 画面リスト

必要な画面を記載してください。
画面名だけでもOK、主な要素や補足があればサブリストで追記してください。

- S-001: ログイン／トップ画面
    - Microsoft SSO後のランディング
    - ダッシュボード等への入口
- S-002: 案件検索画面
    - 案件Noやクライアントなどで検索
    - 検索結果一覧から受注伝票画面へ遷移
- S-003: 受注伝票登録・変更・照会画面
    - 上部: 案件No入力、検索ボタン、タブ（Summary/関連案件/案件情報入力/注文書/アクション履歴）
    - 中央: ヘッダ情報、状況サマリ、ネクストアクション、簡易ダッシュボード（売上推移グラフ）
    - 下部: Item（メンバー明細）テーブル
    - モード: 照会/変更/新規登録
- S-004: 売上計上画面
    - 計上期間指定、対象明細抽出
    - 会計伝票一括作成
- S-005: 案件ダッシュボード画面
    - 案件別の受注・売上・目標推移グラフ
    - 縦軸: 金額、横軸: 年月
- S-006: アサイン状況マトリクス画面
    - 行: メンバー、列: 期間（月）
    - セル: 予定稼働率/確定稼働率
    - 3ブロック表示: アベイラブル/アサイン予定/アサイン確定
- S-008: マスタ管理画面群
    - クライアント、エンドクライアント、メンバー、セクター等の編集
- S-009: 監査ログ照会画面
    - 操作履歴の検索・照会

---

### B2. 画面遷移（わかっている範囲）

どの画面からどの画面に移動するか記載してください。
わからなければ空欄でOKです。

- ログイン → ダッシュボード（トップ）
- トップ → 案件検索、案件ダッシュボード、アサインマトリクス、売上計上、マスタ管理
- 案件検索 → 受注伝票（照会モード）
- 受注伝票 → 変更モード切替、新規登録モード

---

## Part C: デザイン希望（任意）

### C1. デザインスタイル

- 業務システムとして使いやすいシンプルなUI
- 社内標準UIライブラリに準拠

### C2. レスポンシブ対応

- [x] PC のみ
- [ ] PC + タブレット
- [ ] PC + タブレット + スマホ（フル対応）

### C3. 参考画像

-

---

## Part D: ビジネスルール（任意だが推奨）

> **Note**: 業務ルールや計算ロジックが明確な場合は記入してください。
> Domain Spec の Business Rules セクションに反映されます。

### D1. 業務ルール

- 変更モードでは既存明細の物理削除不可（論理削除のみ）
- 受注伝票表示開始時に排他ロックを取得
- 他ユーザーが編集中の案件は照会モードのみ許可
- アサイン状況は終了日と今日の日付で自動更新（assign_end_date < 今日 → アサイン終了）
- 売上計上後は当該明細のrecognized_revenueを累計計上額に更新

### D2. バリデーションルール

- 日付形式: YYYY/MM/DD 以外はエラー
- 必須項目が空の場合はエラー
- 契約期間: contract_start_date <= contract_end_date
- アサイン期間: assign_start_date <= assign_end_date
- 稼働率: 0〜100（小数第2位まで）
- 金額系: 負数禁止、0は許容

### D3. 計算ルール

- 稼働月数 = (終了日 - 開始日 + 1日) / 30（小数第3位で四捨五入）
- 単月小計 = 単価 × (稼働率/100) × 数量 − 値引額
- 概算売上 = 単月小計 × 稼働月数
- 正味額 = 明細の概算売上合計
- 単月平均 = 正味額 / 契約月数
- チャージ率(%) = 実売単価 ÷ 社内標準売価 × 100

---

## 入力完了後

1. このファイルを保存
2. Claude Code に「Vision Spec を作成して」と依頼
3. Claude が内容を読み取り、Vision Spec を生成します
4. 画面情報（Part B）があれば、続けて Design フェーズでも活用されます
